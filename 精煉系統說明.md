# 精煉系統說明

## 隨機材料產出機制

### 工作原理
- 精煉系統使用 `random.choice()` 函數從可用材料中隨機選擇
- 每種材料（鐵、銅、石）的產出機率均等（33.33%）
- 每次精煉都是獨立事件，不受之前結果影響

### 測試結果
經過多次測試驗證：
- 1000次隨機選擇測試：鐵34.0%，銅33.4%，石32.6%
- 20次精煉測試：鐵30.0%，石30.0%，銅40.0%
- 分布都在合理範圍內

### 用戶反饋分析
用戶報告"只產出一種產物"的原因：
1. **樣本量不足**：如果只進行1-2次精煉，確實可能連續獲得同一種材料
2. **隨機性誤解**：隨機不等於均勻分布，短期內可能出現連續相同結果
3. **正常現象**：這是隨機系統的正常行為

### 建議
- 進行多次精煉測試（建議10次以上）來驗證隨機性
- 理解隨機性在短期內可能出現連續相同結果
- 長期來看，三種材料的產出會趨於均等

### 技術實現
```python
# 精煉路由中的隨機選擇邏輯
available_materials = Material.query.filter_by(is_active=True).all()
selected_material = random.choice(available_materials)  # 均等機率隨機選擇
```

### 驗證方法
可以運行以下測試腳本驗證隨機性：
- `test_materials.py` - 測試材料數據庫狀態
- `test_multiple_refining.py` - 模擬多次精煉
- `check_refining_history.py` - 檢查精煉記錄歷史 